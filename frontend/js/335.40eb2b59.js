"use strict";(self["webpackChunksales"]=self["webpackChunksales"]||[]).push([[335],{5580:function(s,t,e){e.d(t,{Z:function(){return w}});var r=e(3396);const o={class:"lds-ring"},i=(0,r._)("div",null,null,-1),a=(0,r._)("div",null,null,-1),n=(0,r._)("div",null,null,-1),u=(0,r._)("div",null,null,-1),c=[i,a,n,u];function d(s,t){return(0,r.wg)(),(0,r.iD)("div",o,c)}var l=e(89);const h={},p=(0,l.Z)(h,[["render",d]]);var w=p},8335:function(s,t,e){e.r(t),e.d(t,{default:function(){return L}});var r=e(3396),o=e(9242);const i={class:"home container"},a={key:0,class:"last-page-info error-message"},n={key:1,class:"network-error error-message"},u={key:2,lass:"network-error error-message"};function c(s,t,e,c,d,l){const h=(0,r.up)("Title"),p=(0,r.up)("ProductCardSet"),w=(0,r.up)("Loader");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r.Wm)(h,{title:"Профиль",description:"Добавленные в избранное товары"}),(0,r.Wm)(p,{products:d.products},null,8,["products"]),(0,r.wy)((0,r.Wm)(w,{ref:"loader",class:"loader"},null,512),[[o.F8,d.isShowLoader]]),d.isLastPage?((0,r.wg)(),(0,r.iD)("p",a," Больше акций в избранном нет ")):(0,r.kq)("",!0),d.isHasNetwork?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("p",n,[(0,r.Uk)(" Не удалось загрузить акции "),(0,r._)("span",{onClick:t[0]||(t[0]=t=>s.getPosts|(d.isShowLoader=!0)|(d.isHasNetwork=!0)),class:"network-error__button"}," Попробовать снова? ")])),d.isUserAuth?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("p",u," Авторизуйтесь, чтобы добавлять акции в избранное "))])}e(7658);var d=e(8862),l=e(1034),h=e(5580),p=e(8448),w={components:{ProductCardSet:d.Z,Loader:h.Z,Title:p.Z},data(){return{products:[],page:1,isShowLoader:!0,isLastPage:!1,isHasNetwork:!0,isUserAuth:!0}},methods:{async onLoaderInScreen(s){s[0].isIntersecting&&await this.pushProducts()},async pushProducts(){const s=await this.getProducts();s&&(this.products.push(...s),this.page+=1)},async getProducts(){try{const s=await l.Z.getLikes({page:this.page});!s.next|!s.results.length&&(this.isLastPage=!0,this.isShowLoader=!1);let t=this.convertLikesToProducts(s.results);return t}catch(s){"ERR_NETWORK"==s.code?(this.isHasNetwork=!1,this.isShowLoader=!1):404===s.response.status?(this.isLastPage=!0,this.isShowLoader=!1):401===s.response.status&&(this.isShowLoader=!1,this.isUserAuth=!1)}},convertLikesToProducts(s){let t=[];for(let e of s){let s=e.product;s.is_liked=!0,t.push(s)}return t},reloadProducts(){this.products=[],this.page=1,this.isLastPage=!1,this.isShowLoader=!0}},mounted(){const s=new IntersectionObserver(this.onLoaderInScreen);s.observe(this.$refs.loader.$el)},computed:{currentUser(){return this.$store.state.currentUser},isAuth(){return this.$store.state.isAuth}},watch:{currentUser(s,t){this.reloadProducts()},isAuth(s,t){this.isUserAuth=s,this.reloadProducts()}}},g=e(89);const k=(0,g.Z)(w,[["render",c]]);var L=k}}]);
//# sourceMappingURL=335.40eb2b59.js.map